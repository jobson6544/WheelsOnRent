{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-6">
            <h2>{{ vehicle.model }}</h2>
            {% if vehicle.image %}
                <img src="{{ vehicle.image.url }}" class="img-fluid rounded mb-3" alt="{{ vehicle.model }}" style="max-height: 300px; width: auto;">
            {% else %}
                <img src="{% static 'images/default_vehicle.jpg' %}" class="img-fluid rounded mb-3" alt="Default Vehicle Image" style="max-height: 300px; width: auto;">
            {% endif %}
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Vehicle Details</h5>
                    <p class="card-text">
                        <strong>Registration:</strong> {{ vehicle.registration.registration_number }}<br>
                        <strong>Type:</strong> {{ vehicle.model.sub_category.category.category_name }}<br>
                        <strong>Company:</strong> {{ vehicle.model.sub_category.company_name }}<br>
                        <strong>Year:</strong> {{ vehicle.model.model_year }}<br>
                        <strong>Availability:</strong> 
                        {% if vehicle.availability %}
                            <span class="badge bg-success">Available</span>
                        {% else %}
                            <span class="badge bg-danger">Not Available</span>
                        {% endif %}<br>
                        <strong>Current Rental Rate:</strong> ${{ vehicle.rental_rate|floatformat:2 }} per day
                    </p>
                </div>
            </div>
            
            <div class="card mt-3">
                <div class="card-body">
                    <h5 class="card-title">Price Information</h5>
                    <p class="card-text">
                        <strong>Suggested Rental Rate:</strong> ${{ suggested_price|floatformat:2 }} per day
                    </p>
                    {% if suggested_price > vehicle.rental_rate %}
                        <p class="text-success">Price could be increased by ${{ suggested_price|subtract:vehicle.rental_rate|floatformat:2 }}</p>
                    {% elif suggested_price < vehicle.rental_rate %}
                        <p class="text-danger">Price could be decreased by ${{ vehicle.rental_rate|subtract:suggested_price|floatformat:2 }}</p>
                    {% else %}
                        <p class="text-info">Current price matches the suggested price</p>
                    {% endif %}
                    <form method="post" class="mt-3">
                        {% csrf_token %}
                        <button type="submit" name="update_price" class="btn btn-primary">Update to Suggested Price</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mt-3">
        <a href="{% url 'vendor:update_vehicle' vehicle_id=vehicle.id %}" class="btn btn-secondary">Edit Vehicle</a>
        <a href="{% url 'vendor:vendor_vehicles' %}" class="btn btn-outline-primary">Back to List</a>
    </div>
</div>
{% endblock %}